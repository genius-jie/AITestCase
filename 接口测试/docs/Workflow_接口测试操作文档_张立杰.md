# JMeter 接口测试工作流指南 (Workflow Guide)

本指南详细记录了从**单接口调试**到**规则沉淀**，最终生成**数据驱动测试 (DDT)** 的完整操作流程。请遵循此流程以确保测试脚本的高质量和可维护性。

---

## 阶段一：JMeter 调试 (Debug)

**目标**：跑通单个接口，验证请求参数、响应结构和基础断言逻辑。

### 1. 操作步骤
1.  **提供信息**：向 AI 提供接口文档（cURL/Swagger）和基础测试场景。
2.  **生成脚本**：要求 AI 生成包含 `ViewResultsTree` 的基础调试脚本。
3.  **执行验证**：运行脚本，检查响应数据。
4.  **迭代修复**：根据报错信息（如 401 Auth、JSON 解析失败）调整脚本。


## 阶段二：规则沉淀 (Rule Extraction)

**目标**：从调试过程中总结通用规则（如特殊断言、变量提取、插件配置），并固化到提示词中，避免重复踩坑。

### 1. 操作步骤
1.  **识别问题**：在调试中遇到的通用问题（例如：CSV 中 JSON 字段需要 `quotedData=false`，或者 WebSocket 插件版本不兼容）。
2.  **触发更新**：使用 **Flash Update** 机制，要求 AI 将解决方案更新到 `JMeter脚本编写智能体提示词.md` 或项目规则中。
3.  **验证规则**：确保新规则被记录在 `Rules & Constraints` 或 `Best Practices` 章节。


## 阶段三：DDT 生成 (Data-Driven Testing)

**目标**：基于沉淀的规则和测试用例，批量生成测试数据 (CSV) 和最终执行脚本 (JMX)。

### 1. 操作步骤
1.  **准备输入**：
    *   已验证的调试脚本（作为模板）。
    *   测试用例列表（Markdown/Excel）。
    *   已沉淀的规则文件（`JMeter脚本编写智能体提示词.md`）。
2.  **生成数据**：要求 AI 根据测试用例生成覆盖正例、反例、边界值的 CSV 数据文件。
3.  **生成脚本**：要求 AI 将调试脚本改造为 DDT 脚本（添加 `CSVDataSet`，参数化变量）。
4.  **最终验证**：运行 DDT 脚本，检查所有用例的执行结果。

## 附录：常用指令速查

| 场景 | 简易指令 |
| :--- | :--- |
| **调试** | "帮我写个 JMeter 脚本测一下这个接口，先跑通就行。" |
| **报错** | "脚本报错了，错误信息是...，请分析原因并修复。" |
| **沉淀** | "这个坑通过了，请把解决方案更新到提示词里，下次别再错了。" |
| **DDT** | "调试好了，现在根据这些测试用例生成 CSV 和最终脚本，记得用刚才总结的规则。" |
| **清理** | "测试完成了，请把临时调试脚本删除，只保留最终版本。" |

1️⃣ 第一步：让 JMeter 智能体调试并生成规则
"请运行当前的 JMeter 脚本进行调试。如果调试通过，请：
1. 识别当前测试的接口名称（从脚本文件名、HTTP 请求路径或测试场景中提取）
2. 根据脚本中的 CSV 配置和断言逻辑，生成一份 e:\AI测试用例\接口测试\rules\[接口名称]_数据契约规则文档.md
3. 在规则文件中明确数据格式和业务规则"
 2️⃣ 第二步：让 DDT 智能体生成数据
"请读取 e:\AI测试用例\接口测试\rules\DDT_Generation_Rules.md 中的规则，严格按照契约生成 1000 条测试数据，保存到 e:\AI测试用例\接口测试\data\intent_recognition_test_data.csv 。"


整体效果评测流程：
提示词有架构师（DDT测试数据管理智能体提示词）-先保存原始接口文档（+提示词）=原始契约文档（意图识别数据契约文档）-执行测试-（接口文档，jtl测试结果，测试数据csv）=更新接口契约文档（意图识别数据契约文档）+业务数据设计师（DDT流程分析与提示词优化建议）-再根据提示词+契约优化+追加数据（覆盖多场景）
幻觉问题：
1. 生成的数据中包含了不符合数据契约规则的字段值（例如：空字符串、超出范围的数值）。
2. 生成的数据中包含了不符合业务规则的字段值（例如：无效的邮箱格式、超出长度限制的字符串）。