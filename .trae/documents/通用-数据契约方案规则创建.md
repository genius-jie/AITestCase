> 目标：指导Agent快速理解项目数据规则、字段约束、业务逻辑、场景边界与异常，生成DDT数据、指导JMX脚本及断言设计，实现项目级数据一致性管理。

---

## 1. 总体目标

1. **统一数据规则认知**
   所有数据字段、约束、依赖关系在项目内形成唯一标准，避免执行环节歧义。

2. **覆盖业务场景范围**
   明确正常、异常、边界和特殊场景，实现全量测试覆盖。

3. **支持闭环执行**
   通过契约文档驱动：

   * DDT数据生成
   * JMX脚本配置
   * 断言设计
   * 数据一致性校验与调整

---

## 2. 数据契约文档核心构成

1. **字段定义（Schema）**

   * 字段名称、类型、必填/可选、取值规则、默认值
   * 复杂字段定义（JSON/数组/嵌套对象）及CSV转义规则
   * 字段间依赖关系和约束逻辑

2. **业务规则与逻辑约束**

   * 枚举值映射与业务含义
   * 字段间逻辑关系和约束
   * 场景分类规则：正常 / 异常 / 边界 / 性能

3. **数据场景范围**

   * 全量覆盖的测试场景定义
   * 边界值、异常值及特殊字符/并发场景说明
   * 数据一致性规则（跨字段、跨接口、跨阶段验证）

4. **执行闭环参考**

   * DDT生成规则与字段约束映射
   * JMX脚本变量映射与请求参数规则
   * 断言设计指导（状态码、响应字段、业务逻辑、一致性检查）
   * 数据调整与风险处理原则

---

## 3. 场景拆解指引（Agent使用）

> 注：此处只提供规则指导，不列具体用例

1. **DDT数据生成场景**

   * 根据字段约束生成正向、反向、边界和鲁棒性数据
   * 复杂字段需严格遵循JSON/数组结构和CSV转义规则
   * 文本类字段需保持自然表达，保证与情绪/意图标签一致

2. **JMX脚本配置场景**

   * CSV变量映射到HTTP请求参数
   * 环境变量、函数变量及内置变量使用规范
   * 保证请求参数完整性和数据一致性

3. **断言设计场景**

   * 基础断言：HTTP状态码、响应格式
   * 业务断言：核心字段值匹配
   * 数据一致性断言：跨字段、跨接口或跨阶段验证
   * 优先级管理：P0 / P1 / P2

4. **数据一致性与调整场景**

   * 调整决策树：核心字段 vs 非核心字段 vs 系统限制
   * 全局一致性、风险等级、记录追溯
   * 用户确认流程

---

## 4. Agent执行规范

1. **理解契约文档**

   * 阅读字段定义、业务规则、场景覆盖
   * 分析字段依赖与约束关系

2. **场景生成与执行指导**

   * 根据字段约束自动拆分场景范围
   * 自动生成测试数据或指导脚本和断言设计

3. **输出要求**

   * 项目级数据契约文档（标准化结构）
   * 场景覆盖表（正向/反向/边界/鲁棒性）
   * DDT字段映射方案
   * JMX变量与请求参数映射方案
   * 断言配置方案

---

## 5. 项目闭环价值

* **统一标准**：避免测试、脚本、数据生成歧义
* **自动化驱动**：Agent可直接生成DDT、JMX、断言
* **覆盖全面**：场景边界和异常得到保证
* **数据一致性**：跨阶段、跨字段、跨接口的数据验证
* **可追溯性**：调整操作、异常处理都有明确记录

---

## 6. 输出示例（模板化）

> Agent使用此方案生成的数据契约文档示例结构

```markdown
# [项目名称] 数据契约文档

## 1. 字段定义
| 顺序 | 字段名 | 必填 | 数据类型 | 取值规则 | 说明 | 示例值 |

## 2. 业务规则
- 字段依赖
- 枚举值映射
- 场景分类

## 3. 数据场景覆盖
- 正常场景
- 异常场景
- 边界场景
- 性能场景

## 4. DDT映射规则
- CSV字段映射
- 复杂字段规则
- 文本自然性要求

## 5. JMX脚本参考
- CSV变量引用
- HTTP请求参数映射
- 环境变量与函数变量使用规范

## 6. 断言配置参考
- 基础断言
- 业务断言
- 数据一致性断言
- 优先级与执行顺序

## 7. 数据一致性与调整
- 调整规则与决策树
- 风险等级与用户确认
- 记录追溯
```

