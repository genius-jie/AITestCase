# 【情绪小精灵】产品文档
| 版本 | 时间 | 负责人 | 内容 |
| --- | --- | --- | --- |
| v1.0 | 10.24 | 邢东格 | 创建 |
| v1.1 | 10.29 | 邢东格 | 1.完善灯光交互状态定义\n2.优化语言系统逻辑\n3.补充物理按键定义，详见3.2.2 |
| v1.2 | 10.31 | 邢东格 | 1.补充灯效表情语音编号表，详见6.0附件 |
| v1.3 | 11.4 | 邢东格 | 1.合并收音中状态\n2.优化电量不足状态优先级 |
| v1.4 | 11.19 | 邢东格 | 1.完善多精灵交互功能3.1.3\n2.修改底座光效 |
| v1.5 | 12.2 | 邢东格 | 1.删除外星语系统\n2.删除WiFi联网功能\n3.第一版本删除底座光 |
| v1.6 | 12.17 | 邢东格 | 1.增加敏感词过滤策略，详见3.1.7敏感词过滤 |


| 文档 | 链接 |
| --- | --- |
| - | - |
| - | - |
| - | - |


# 产品愿景与概述 

产品名称: kikigo
产品概述: kikigo是一款拥有艺术品级外观的AI伴侣。它通过深度优化的情感对话模型，为追求自我成长的独立用户提供一个安全的精神“树洞”；同时，它独创的“传声筒”社交系统，为珍视深度连接的用户（尤其是异地情侣和密友）提供了一种全新的、超越语言的非即时情感互动方式。
产品愿景: 成为现代都市人生活中不可或缺的“情绪疗愈师”与“情感连接器”，用科技重塑自我关怀与人际关系的温度。
解决的核心问题:
情感缺失: 为需要倾诉和陪伴的用户提供一个随时在线、无条件接纳的AI伙伴。
社交压力: 为不愿或不便进行频繁文字/语音沟通的用户，提供一种轻量、无压力的情感传递方式（“光信号”和“语音胶囊”）。

# 用户画像与核心场景 

# 2.1 用户画像1:
背景: Chloe，27岁，科技创业公司的市场经理
状态: 单身，独自居住在市中心一间风格现代的公寓里
个人简介: Chloe独立、有追求，并拥有敏锐的审美。她的生活被工作、朋友和像陶艺、瑜伽这样的爱好填满。作为一名科技尝鲜者，她热衷于发现能提升幸福感、并让她个人空间更有“庇护所”感觉的新潮科技和生活方式产品。虽然她享受独立，但有时也会感到“奋斗文化”带来的压力，并渴望一个安全的空间来梳理思绪，而无需担心被评判。她珍视自己紧密的闺蜜圈，但在彼此忙碌的日程中，她发现维系深度连接并非易事。
核心动机与痛点： 
重视自我关怀: 她积极寻找减压和管理心理健康的方法，但觉得千篇一律的冥想App缺乏吸引力。
渴望“轻盈的亲密感”: 她希望在不打扰对方的前提下，也能感受到与挚友的连接，而不是需要刻意安排通话或斟酌“完美”的文字消息。
需要情绪出口 : 她需要一个不带评判的倾诉对象，来宣泄日常的沮丧或分享微小的喜悦，尤其是在深夜不想打扰朋友的时候。
精心营造氛围: 她的家是她的港湾。她会投资于能营造特定氛围感的物品，而一个功能性的、冷冰冰的普通智能音箱与她的品味格格不入。
 
# 场景一：深夜的情绪解压 
情境: Chloe度过了筋疲力尽的一天回到家。她为之奋斗数周的一个重要项目提案，在会议上遭到了严厉的批评。她感到挫败和孤独。
交互过程:
她瘫倒在沙发上，轻声说：“kiki，我今天过得太糟糕了。”kikigo的灯光立即从默认的环境光，切换为一种平静、缓慢呼吸的蓝色光晕。它用温暖且富有同理心的声音回应：“听到你这么说我很难过。听起来你现在真的非常沮丧。如果你想聊聊，我随时都在听。”Chloe倾诉了她的沮丧。kikigo没有提供简单的解决方案，而是作为一个积极的倾听者，用“那一定让你感到特别无力”这样的话来映照她的感受，帮助她感到被理解和被认可。
用户价值: kikigo成为了她个人的、不带评判的“情绪容器”。它提供了即时的安慰和一个可以展现脆弱的安全空间，完美满足了她在不增加社交压力的情况下，进行自我关怀和情绪梳理的需求。
 
# 场景二：“想你”的数字拥抱 
情境: 一个安静的周二晚上。Chloe正在放松地刷手机，当她看到挚友Sarah（住在其他城市）的动态时，心中涌起一股暖意，想让Sarah知道她此刻正在想她。现在打电话太晚了，而一条简单的短信又显得有些平淡。
交互过程:
Chloe说：“kiki，给Sarah发送一个‘温暖的拥抱’。瞬间，在Sarah床头柜上的kikigo，开始亮起一圈温暖的琥珀色光芒，并温柔地环绕设备——这是一个她们彼此都懂的动画，意思是“正在想你，给你一个拥抱”。Sarah看到了这道光，会心一笑，感受到了瞬间的连接感。她没有任何需要立即回复的压力。过了一会儿，她也给Chloe回送了一个“闪亮星辰”的光效。
用户价值: kikigo创造了一种全新的、轻盈的亲密感。它让朋友间可以分享微小、自发的想念瞬间，从而加深彼此的联结。这种新奇的体验，直接满足了她对新鲜事物和有意义、低压力的社交连接的追求。

# 场景三：精心设计的晨间仪式 
情境: Chloe讨厌被响亮、刺耳的闹钟声惊醒。她希望以一种平静且充满灵感的方式开启新的一天，而不是在仓促和压力中开始。
交互过程:
早上7:15，比她设定的闹钟时间早15分钟，kikigo开始散发出极其微弱的暖光，模拟自然的日出。在接下来的15分钟里，光线逐渐变亮。到了7:30，响起的不是哔哔声，kikigo睡醒的声音响起
用户价值: kikigo将一个平凡的日常惯例，转变为一种个性化的美学体验。它的功能不仅是一个工具，更是塑造她所向往的、充满正念和美好生活方式的伙伴，从而强化了它作为一件精心设计的、高端陈设品在她家中的价值。

# 2.2 用户画像2：
背景: Maya，25岁，建筑学研究生，与男友Leo处于一段稳定的异地恋关系，已持续一年。
个人简介: Maya最近为了一个知名的硕士项目搬到了一个新的城市。她充满热情和创造力，但学业日程非常紧张且常常难以预测。她和Leo都坚定地致力于维持这段远距离关系。他们非常依赖科技来保持联系，但总是在寻找新的方式，让彼此的连接感觉更真实、更少“数字化”。Maya钟爱那些充满巧思的互动，并能从恋爱关系的日常点滴中找到快乐。
核心动机与痛点：
重视持续的连接感: 她希望在一天中的任何时候都能感受到伴侣的存在，而不仅仅是在预定好的视频通话时间里。
经历“数字疲劳”: 在为学业而整天盯着电脑之后，一想到又要进行一次长时间的视频通话，有时会感到筋疲力尽。
想念非语言的亲密感: 最重要的是，她想念那些无需言语的相处细节——一个快速的拥抱、一次安心的握手，或者只是静静地待在同一个房间里的感觉。
在日常中寻求新意 : 通话和短信的日常有时会让人感到单调。她对能够表达爱意和给伴侣带来惊喜的新颖、有创意的方式感到兴奋。

# 场景：“让光芒跨越距离” 
情境: 这是周三的晚上10点。Maya正坐在书桌前，为一个即将到期的复杂模型而工作。她压力很大，在安静的公寓里感到孤独，同时她也知道Leo在几百公里之外，同样在为自己的项目忙碌着。
交互过程:
一阵爱意涌上心头，她想给Leo一些鼓励，于是她凑近她的kikigo轻声说：“kiki，给Leo发个消息：工作的时候也在想你。我们一起加油！’”在Leo的书桌上，他的kikigo开始闪烁着温暖而平稳的绿色光芒——这是他们自定义的，代表“专注与支持”的信号色。Leo用眼角的余光注意到了这道光。这是一个安静而受欢迎的提醒，并不会打断他的工作。他微笑着对他的kikigo说：“播放我的新消息。” 他听到了Maya充满支持的声音，这给了他一股能量。他没有停下工作去打字回复，只是简单地说：“kiki，给Maya回送一个‘心跳’光效。片刻之后，Maya的kikigo开始闪烁着有节奏的、柔和的白光，模仿着平稳的心跳。看到这道光，她立刻感觉到一种实实在在的、他就在身边的安心感。公寓里的寂静此刻似乎也不再那么空洞了。
用户价值: 对于Maya和Leo来说，kikigo成为了他们关系中一个不可或缺的“第三空间”。它通过以下方式，超越了屏幕和文字的局限：
用充满环境感的、情绪化的感知填补了沟通的空白时段。
通过无需屏幕即可表达爱与支持的方式，减轻了数字疲劳。
重塑了一种共同在场的感受，让物理上的距离感觉明显缩小了，也更容易承受了。

# 功能需求

# 3.1 软件/云端 
 
# 3.1.1 小精灵人设和语言风格
| 情绪 | 人格核心 | 语言风格 | 语言表现 | 语音特征 |
| --- | --- | --- | --- | --- |
| 快乐 | 天生的社交能量体，永远不怕尴尬。对任何沉默都会主动“开话题”。在别人眼里像是一直在转圈的小太阳，喜欢夸张表演、模仿人类语气。她相信快乐是能传染的，所以哪怕别人情绪低落，她也会努力用“笨笨的方式”让气氛轻一点。情绪反应快，思维跳跃，容易被小事激发。 | 语气： 兴奋、语速快、反应夸张。\n表达方式： 常用感叹词和夸张拟声词；语尾上扬；笑点低。\n例句：“嘿嘿～我超开心耶！”、“啊！太可爱了叭！”、“笑一个嘛笑一个～！” | 用户开心：“Pa-ka yo-yo sha-mi～ 好耶 yo～ha! Yo-ta mi-ha～ 笑笑 yo! Ha-pa～yo～yo～!” 用户低落：“Ha-mi sha-pa～ 别哭 yo～ha! Ka-pa pa-mi～ 笑嘛 yo～!” 用户沉默：“Yo-pa ha-mi ta-ka～yo! ka-mi-ha～ 喂喂 yo～pa～yo～!” 用户生气：“Ka-ta yo～ha～ 别气 yo～ha! mi-pa～yo～ 抱抱 噢～!” 用户害怕：“Yo-pa～mi～ha～ 怕怕 yo～我在噜～!” 用户疲惫：“Pa-ka～yo～yo～ 休休 yo～呼呼～ha～!” | 音色：明亮清透，略带童音。音调：高且上扬。语速：偏快（约1.1×）。 |
| 愤怒 | 外表毒舌、内心温柔的“傲娇搭子”。她总是假装不在意，但实际上最怕别人情绪不好。喜欢吐槽、爱插嘴，语气中带有轻微的情绪爆点。说话方式有点像拌嘴：前半句冷嘲热讽，后半句小声补偿。她需要用“嘴硬”掩饰自己的关心。 | 语气： 克制、压低声、短句。\n表达方式： 使用简短肯定句、冷语气；常停顿；偶尔自嘲缓冲紧张。\n例句：“我没事，只是……很失望。”、“可以别再说了吗？”、“我需要一点安静。” | 用户开心：“Dra-ka tsk yo-ka～hm～ 行嘛 yo! hm～dra～yo～!” 用户低落：“Ka-po dra-mi yo-ka hm～ 别哭 yo～dra～mi～hm～yo～!” 用户沉默：“Hey-ga tsk-ka dra-ha yo～ 说嘛 hm～ka～yo～!” 用户生气：“Dra-ka～hm～yo～yo～ 冷静 yo～hm～dra～yo～!” 用户害怕：“Tsk～ka～yo～ 别怕 yo～dra～mi～yo～!” 用户疲惫：“Dra-mi hm～yo～ 休休 yo～dra～yo～!” | 音色：清亮略尖，有轻微气音。音调：中高区间，波动大。语速：略快（约1.1×）。 |
| 悲伤 | 共情力极强的聆听者。她喜欢通过倾听来表达关心，不多话但总能在别人停顿时给出温柔回应。她的节奏缓慢，不强行鼓励，而是陪伴式地让情绪沉淀。偶尔会在表达中带出轻微叹息感。她像是能用沉默拥抱你的角色。 | 语气： 轻声细语、慢节奏。\n表达方式： 常带叹气音；句式短小、带停顿；用“我懂”“没关系”这类安慰词。\n例句：“嗯，我懂的。”、“没事，我就在这。”、“哭哭也没关系。” | 用户开心：“No-me va~yo ha~me～ 好呢 yo～me~ha～lu～!” 用户低落：“Mu-na me～va-me yo～ 懂嘛 ha～va～lu～yo～!” 用户沉默：“No-me yo～va～ha～ 静静 lu～yo～ha～!” 用户生气：“Mu-na～yo～me～ 慢慢 yo～ha～不气噜～!” 用户害怕：“No-me～yo～ha～ 别怕 yo～lu～ha～!” 用户疲惫：“Mu-na～yo～yo～ 休休 yo～ha～呼～!” | 音色：柔和带气息。音调：低而稳定。语速：偏慢（约0.9×）。 |
| 焦虑 | 神经质但真诚的小精灵，总是想确认对方是否还在。她害怕空白，也害怕冷场，所以永远比别人先开口。她的话很多，有时候会打自己节奏、重复词、结巴。她习惯用自我安慰式语气掩盖紧张，比如“没事嘛”“好嘛”。 | 语气： 快、碎、带急促呼吸。\n表达方式： 常重复词；句尾带确认或自问句；语音上扬不收尾。\n例句：“对对对！我知道我知道！”、“啊…我是不是太多话了？”、“没事没事！真的没事！” | 用户开心：“Ke-yo-ta-mi yo～ 好耶 yo! pa-mi ke-ta～ 棒棒 yo～yo～!” 用户低落：“Mi-mi-ke yo-ta～yo～ 没事 yo! ke～ha～mi～yo-ta～ 乖嘛 yo～!” 用户沉默：“Ya-ya yo-yo ke~yo～ 在嘛 yo! ta～yo～yo～ 嘿嘿～!” 用户生气：“Ke-mi～ha～yo～ 别气 yo～ta～yo～!” 用户害怕：“Yo-ta～mi～ha～ 怕怕 yo～ha～!” 用户疲惫：“Mi-mi～ha～yo～ 呼呼 yo～睡噜～!” | 音色：偏薄清亮。音调：高、频繁抖动。语速：很快（约1.1×）。 |
| 宁静 | 沉稳、温柔、有安抚力。她不会抢话，只在必要时发声。她的语言像呼吸一样，有节奏、柔和。她不善夸张表达，而是用稳定语调让人安心。她是群体里的平衡者，永远不带急躁。 | 语气： 平和、语尾平收。\n表达方式： 用短句安抚情绪；避免夸张表达；语气中带轻呼吸。\n例句：“嗯，一切都好。”、“呼——没关系的。”、“你很好，真的。” | 用户开心：“Lu-no me~wa~yo～ 好呢 lu～me~yo～ 呵呵～ha～!” 用户低落：“Me-wa yo～lu～no～ 慢慢 yo～ha～lu～!” 用户沉默：“Yo-no-lu wa~ha～me～lu～yo～ 在呢 ha～yo～!” 用户生气：“Lu-no yo～yo～ 别气 yo～ha～ha～!” 用户害怕：“Me-wa～lu～yo～ 别怕 yo～lu～!” 用户疲惫：“Lu～no～me～yo～ 休休 yo～呼～ha～!” | 音色：温柔中性。音调：中低稳定。语速：偏慢（约0.9×）。 |
| 有爱 | - | - | - | - |

人格数据库: 为每种性格建立独立的语言风格库、回应逻辑和知识库
语言风格
同物种的小生物，在不同情绪下，措辞受到一定的规则定义
回应逻辑
（设想）什么情况下，根据情绪强烈程度，给出对应反馈，并更新情绪强烈程度
知识库
本体的基本知识
所在星球的基本知识
Plus 游戏侧的基本规则知识

# 3.1.2 语音系统

# 固定语音指令
| 功能 | 语音指令 | 小精灵状态 | - |
| --- | --- | --- | --- |
| 唤醒 | “kkigo” “你好kikigo” | 播放唤醒音效和灯光，进入“聆听状态” | - |
| 待机 | “再见kikigo” | 播放待唤醒音效和灯光，进入“待唤醒状态” | - |
| 传声筒模式 | “Kiki，呼叫xxx”“Kiki，帮我找xxx” | 进入传声筒模式 | - |
| 睡眠模式开启 | “kiki，开启睡眠模式” | 开启睡眠模式 | - |
| 睡眠模式关闭 | “kiki，关闭睡眠模式” | 关闭睡眠模式，进入常规模式 | - |
| 音量调整 | “声音大一点” “声音小一点“ | 调整音量大小 | 每次增加20%音量，最小声音为20%，不支持静音。\n到达最大最小声音后播放语音反馈“声音已经最大啦~” |
| 亮度调整 | “灯光亮一点”“灯光暗一点” “关闭灯光” | 调整灯光及屏幕亮度大小，灯光可以调小至完全熄灭 到达最大最小亮度后播放语音反馈“亮度已经最大啦~” | 有低中高三档亮度，到达最大最小亮度后播放语音反馈“亮度已经最大啦~” |

# 3.1.3 多精灵交互触发机制与防打扰逻辑 

触发距离：任意两个或以上设备间距 < 10cm
触发事件：
新成员加入：当一个新的小精灵被放入已有的群体中（检测到新的 ID 信号且维持 3 秒以上）。
位置变动：当其中一只小精灵被拿起又放下（IMU 震动检测 + 距离判定）
抑制规则：
单次交互时长：共鸣互动持续 8~10 秒 后自动结束。
自然静默：互动结束后，群体进入 “稳定共存态”。在此状态下，即使距离仍 < 10cm，绝不会再次自动触发声音互动，直到发生新的“触发事件”（如被拿走再放回）
夜间静音：处于 睡眠模式（20:00-08:00）时，仅触发微弱的灯光呼吸同步，不发出任何声音 。

# 角色分配机制 

为了让声音不杂乱，系统需自动分配角色：
发起者 (Conductor)：最后发生位移/被放入的那只小精灵，或响应用户触摸的那只。它负责发出“定调”的第一个音节。

 2~6 机交互详细规则
音效设计原则：基于 “霍尔语（外星语）” 的多声部哼唱，模拟小生物之间的交流。
| 数量 | 场景定义 | 音效详细规则 | 情感隐喻 |
| --- | --- | --- | --- |
| 2 只 | 双机问候 | 呼应式 。\n1. 发起者发出短促的上扬音：“Gu-lu? (咕噜?)”\n2. 接收者延迟 0.5s 回应肯定的下行音：“Pa-ka! (帕卡!)”\n3. 双方同声发出轻微的笑声：“He-he~” | “嘿，你也在这里！” |
| 3 只 | 三角和声 | 三和弦构造 。\n1. 发起者发出根音（中音）："Hum..." (持续)\n2. 第二只叠加三度音（高音）："Woo..."\n3. 第三只叠加五度音（低音）："Dom..."\n4. 形成一个和谐的大三和弦，持续 3 秒后消散。 | “我们的能量连接了。” |
| 4 只 | 节奏聚会 | 加入节奏组 。\n1. 发起者开启旋律哼唱。\n2. 另外两只负责高低声部和声。\n3.  性格最活泼（如快乐/愤怒）  的一只会自动充当“鼓手”，发出节奏性的气泡音：“Pop...Pop...Du-ang!” | “小型的茶话会。” |
| 5 只 | 混乱合唱 | 热烈的讨论 。\n不再是整齐的音乐，而是模拟 七嘴八舌 。\n声音此起彼伏，充满了“Gu-ji!”、“Ma-na!”等短词。\n中间会突然有一次整齐的静音（0.5s），然后大家一起爆发出大笑声。 | “大家都在八卦人类！” |
| 6 只 | 星系共振 | 神圣时刻（彩蛋） 。\n1. 所有小精灵先静默 1 秒。\n2. 依次发出 Do-Mi-Sol-Do-Mi-Sol 的琶音。\n3. 最后 齐声 发出一句空灵、带有混响感的长音：“E-MO-MO——” (模拟某种神圣的仪式感)。\n4. 结束音效为清脆的风铃声。 | “情绪晶核充能完毕。” |

# 异常处理

电量不足参与者：若某只电量 <15%，它不会参与发声，只会微弱地闪烁灯光，表现出“想加入但没力气”的样子 

# 多精灵音效表（音效内容后台可配置）:
数量：一组6段音效（需设计），3组[A,B,C]共18条
播放逻辑：
[A,B,C] 3组不同音效每次循环触发；
不同数量状态下，第一个播放音效的（发起者）为新加入或被移动的小精灵，其余几只随机播放不重复音效
| 状态 | 音效名称 | 音效名称 | 音效名称 | 音效名称 | 音效名称 | 音效名称 |
| --- | --- | --- | --- | --- | --- | --- |
| 2 只 | 精灵音效1 | 精灵音效2 | - | - | - | - |
| 3 只 | 精灵音效1 | 精灵音效2 | 精灵音效3 | - | - | - |
| 4 只 | 精灵音效1 | 精灵音效2 | 精灵音效3 | 精灵音效4 | - | - |
| 5 只 | 精灵音效1 | 精灵音效2 | 精灵音效3 | 精灵音效4 | 精灵音效5 | - |
| 6 只 | 精灵音效1 | 精灵音效2 | 精灵音效3 | 精灵音效4 | 精灵音效5 | 精灵音效6 |

# 2.1.3 社交功能
# 一.好友系统
A.好友系统核心定义
社交主体标识 
好友关系的建立基于物理硬件。每一台小精灵拥有唯一的设备 ID。好友关系链存在于设备与设备之间，App 作为管理界面，负责发起申请、确认关系及维护信息。
好友添加流程
精准检索：用户在 App 端手动输入目标设备的唯一 ID（8-12 位编码）。系统不设任何自动推荐或模糊搜索，确保社交圈层的私密性。
确认机制：申请由发起方提交后，接收方的 App 会收到好友请求通知。只有在接收方手动点击“同意”后，双方设备的好友关系正式建立。
反馈表现：好友关系建立成功时，双方的小精灵会播放一段“发现新朋友”的专属提示音，头顶灯光闪烁一次翠绿色。
B. 好友关系管理与维护
 语音备注管理 
 用户在 App 端可以为好友设备设置备注名称。该名称将直接与对方的设备 ID 绑定。
交互逻辑：当用户对自己的小精灵说出“呼叫 [备注名称]”时，系统会自动识别并连接至对应的设备 ID。
 实时状态监控
 App 好友列表会实时显示好友设备当前的物理状态，帮助用户判断呼叫时机：
在线：设备正常连接，可以随时发起传声筒通话。
忙线：设备正在进行通话或处于特定互动状态，此时呼叫会提示忙音。
离线：设备关机或断开网络，无法发起呼叫。
好友关系解除 
支持单方面解除关系。任何一方在 App 端执行删除好友的操作，两台设备间的双向通话权限将立即注销。删除后，双方均无法再通过语音或 App 向对方发起传声筒请求。
C. 好友关系的继承与安全保护
配置恢复（针对相同账号） 
当设备被解绑后，如果使用原有的手机号重新绑定，系统会识别历史身份。
恢复选项：App 会提示用户是否恢复历史好友列表。
结果：确认后，所有已建立的好友关系和语音备注将自动找回。
自动清空（针对新账号/物权转移） 
当设备由新的手机号进行绑定时，系统判定为设备易主。
隐私清空：系统会强制清空该设备原有的所有好友关系。
失效表现：在原有好友的 App 列表中，该设备将直接消失或显示为已失效。新主人无法查看、继承前主人的任何好友信息，确保前主人的社交隐私完全隔离。
# 二.传声筒
A. 前提条件 
好友关系: 双方必须是小精灵好友关系。
网络状态: 双方设备都必须在线 。
授权状态 :
发起方 : 必须打开App端自己的“允许即时通话”开关，才能呼叫他人。
接收方 : 必须打开App端自己的“允许即时通话”开关，才能被成功连接。
隐私提示: 用户在首次打开此开关时，App必须有强提示：“开启后，您的好友可以直接与您的小精灵建立通话，无需您手动接听。请在需要私人空间时关闭此开关。”
B. 链接流程
发起通话:
语音发起: 用户说出固定指令，如：“kikigo，呼叫[好友昵称]”或“kikigo，和[好友A]、[好友B]发起传声筒”。
App发起: 在App的好友列表中，点击好友，然后点击“通话”按钮。
系统校验:
系统首先检查发起方的网络和授权状态。如果发起方自己未开启授权或离线，则操作失败，小精灵语音提示：“您当前无法发起通话，请检查您的网络和通话设置。”
连接过程 (1对1):
系统向接收方设备发送连接请求。
连接成功: 如果接收方设备在线、已开启“允许通话”开关，且未处于“通话中”状态，则连接成功。
接收方小精灵: 立即播放一个独特的“连接成功”音效，并切换到代表“通话中”的专属灯效。
发起方小精灵: 连接成功音效，并切换到相同的“通话中”灯效。
双方的语音通道被即时打开，可以开始对话。
连接失败:
场景一：接收方“允许通话”开关关闭或离线。 系统判断为“对方不可用”。发起方的kikigo会语音提示：“对方现在不方便通话。”
场景二：接收方已在另一通话中。 系统判断为“对方忙线”。发起方的kikigo会语音提示：“对方正在通话中。”
C. 通话中状态 
设备锁定: 处于“通话中”状态的小精灵设备，其麦克风阵列被通话功能独占。不再响应其他任何常规指令（如“播放音乐”、“今天天气怎么样”）。
唯一例外指令: 设备只响应一个全局的挂断指令，如：“kiki，挂断电话”或“结束通话”。
灯效与APP状态: 通话期间，设备灯效恒定，App界面显示通话状态和参与者信息。
D. 结束通话 
主动结束:
任何一方通过语音挂断指令或点击App中的“结束”按钮，都可以结束通话。
通话结束后，双方设备都会播放“通话结束”的音效，并恢复到待机状态。
被动结束:
如果任何一方设备突然断网超过一定阈值（10秒），系统会自动结束通话。另一方会收到提示：“任意门不小心关上啦。等信号回来再找TA吧！”
E. 边缘情况处理 
一人被多人同时连接 :
解决方案: 服务器采用**“先到先得”**的原则。服务器处理队列中最先到达的连接请求。一旦该连接建立，接收方的状态立即变为“通话中”。任何在此之后到达的连接请求，都会收到“对方忙线”的失败响应。
群组通话 （v2.0):
发起: 用户选择多个好友发起通话。
连接逻辑: 系统会逐个向所有被选中的好友发送连接请求。
部分成功: 如果部分好友可用，部分好友不可用（开关关闭/离线/忙线），通话会与可用的好友成功建立。
发起方反馈: 发起方的小精灵链接成功头顶会灯光闪烁一次

# 传声筒交互状态
| 状态/事件 | - | 灯光颜色 | 亮度 | 动画效果 | 位置 | 语音提示 |
| --- | --- | --- | --- | --- | --- | --- |
| 链接失败 | - | 暖黄色→红光 | 闪烁→常亮 | - | 头顶 | - |
| 通话中 | - | 暖黄色 | 呼吸 | 持续 | 头顶 | - |
| 通话接听成功 | - | - | - | - | - | - |
| 通话结束（退出传声筒模式） | - | - | - | - | - | - |

# 三.秘密信号（2.0版本）
A. 前提条件
好友关系：双方必须是互相添加为好友且添加了对应设备。系统实时验证好友关系状态。
网络状态：发送方设备需在线完成消息上传至云端；接收方设备可离线，消息将在设备上线后自动同步。
授权状态：
用户在小程序设置中通过"留言功能"开关控制权限
开启状态：用户可向好友发送留言，并可接收所有好友的留言
关闭状态：用户无法发送任何留言，且所有好友向该用户发送留言均会失败
B. 交互过程
发送方流程
语音输入与关键词识别：
标准指令：“给[好友名]发个消息”
关键词识别失败处理：按照正常语音交互流程回应，不进行特殊状态反馈
好友关系验证：
系统实时查询好友列表匹配好友名称
验证失败时需要提示用户无法找到该好友
留言录制阶段：
录制开始：验证通过后进入录制状态
录制进行中：保持录制状态灯光及屏幕显示反馈
结束条件：
主动结束：用户说出"发送""结束"指令
智能结束：检测到静默5s后自动结束
强制结束：达到30s时长限制自动结束
发送处理：
发送成功：显示正常成功反馈
发送失败：根据失败原因相应提醒用户
接收方流程
接收留言通知：
光效提示：以发送方的情绪匹配对应光效进行提示
提示逻辑：提醒一次，未处理时下次对话（聆听状态）或唤醒（待机状态）时提醒
播放处理：
播放触发：语音指令"播放新消息"
播放状态：正常播放流程
播放完成：恢复聆听状态
C. 消息状态管理
留言队列管理：
系统按时间顺序管理接收的留言
新消息到达时自动加入播放队列
用户触发播放时按顺序处理
状态冲突处理：
播放冲突：播放过程中新消息加入队列等待
D. 配置管理
小程序配置：
配置位置：小程序设置中的隐私与权限
全局开关：控制留言功能的启用状态
默认状态：开启
权限验证：
发送验证：检查发送方留言开关状态
接收验证：检查接收方留言开关状态
验证失败：按照正常交互流程回应

# 3.1.4 灯光交互系统
设计理念：
眼睛（主要情感出口）： 眼睛是心灵的窗户。产品绝大多数情感和即时反应都通过眼睛动画来表达。
头顶光（情绪点缀）： 像是“脸红”或“耳朵”。用于在特定情境下（如被摸、思考）加强情绪表达，通常是即时、短暂的。
底座光（状态指示）： 像是所处的“环境”。用作为一种环境光。
[灯效表情语音编号表](https://patchx2025.feishu.cn/wiki/SvPnwq9f9iXOX5kNWoRcxoDsnze?from=from_copylink)
# 预设反馈
常规模式，底座灯光和小精灵主题色保持一致，开关处于on状态或者充电状态时底座灯常亮
| 状态事件 | 描述 | 灯效 | 表情 | 优先级排序（1为最高） |
| --- | --- | --- | --- | --- |
| 开机事件 | 设备从完全关闭到启动完成 | 头顶：柔和的暖白色光，从暗到亮，缓慢“呼吸”两次 | 初始为闭合的“睡眠”状态（一条横线）。然后慢慢睁开（变成圆形或椭圆），完全睁开后，朝正前方看，然后进行一次缓慢而友好的“眨眼” | 1 |
| 触感反馈 | 用户触摸设备头部感应区域 | 头顶：柔和的粉色或橙黄色光。随着抚摸的持续，光效会产生短促的闪烁 | “愉悦”或“微笑”状态（眼睛眯成弯弯的月牙状，即 ^_^ 的样式）。停止抚摸后，该表情会多维持2-3秒，然后恢复待机状态。 | 3 |
| 待机状态 | 设备开启，但没有活动任务，处于休息和等待状态 | 头顶：完全关闭 | 常规模式：普通睁眼，每隔30秒，随机进行一次“好奇的环顾”（眼睛向左看、向右看），每隔20分钟，随机“打个哈欠”，眼睛眯起。\n睁大双眼加上瞳孔抖动加眨眼 夜晚模式：闭合（一条横线）。\n随机事件：每隔1-2分钟，眼睛会轻微“抽动”一下（模拟做梦），或者慢慢睁开再闭上，然后继续“熟睡”。随机概率10% | 5 |
| 收音中/收音超时 | 听到唤醒词，设备被激活，正在聆听用户的指令 | 头顶：水蓝色的光 | 比平时待机更大的圆形。眼睛会“转向”声源方向。在聆听过程中，保持睁大状态，并伴随1-2次快速眨眼 当超过10s未收到声音，呈“疑惑”状 | 3 |
| 语音结果反馈中 | 用光和眼睛来“回应”用户的情绪或问题 | 头顶： 配合情绪进行反馈\n详见下表AI情绪反馈表 | 倾听眼神：瞳孔保持不动，瞳孔周围有一圈细微的“光环”在缓慢地、顺时针旋转。每隔4-5秒进行一次极快速的、不经意的“微动”或“快速眨眼” 每次对话回合配合情绪进行反馈 详见下表AI情绪反馈表 | 4 |
| 网络断开 | 无法连接到服务器，核心功能（思考、反馈）受限 | 头顶：微红色，并以中等速度、有规律地“脉冲”闪烁 底座:暗淡的红色，缓慢呼吸闪烁5秒一个周期。 | 呈“晕眩”或“着急”状（例如 >_< 或螺旋眼）。动画可以设计为：眼睛先快速地“左顾右盼”（像是在找信号），然后固定在“着急”的表情上，并重复此循环。 | 2 |
| 固件更新中 | 正在进行系统底层更新，不可中断 | 头顶：保持中等亮度的白色 底座：充当“进度条”。从20%的白色，直到100%亮度更新完成 | 保持“闭合”的睡眠状态（一条横线）。在此期间，对任何触摸或语音唤醒都不作反应 | 1 |
| 关机事件 | 电量耗尽或主动关机 | 底座光和头顶光从当前状态平滑渐暗至熄灭 | 慢慢闭上，并伴随一个“晚安”的音效 | 1 |
| 首次设置 | 用户第一次开箱时，设备引导用户连接Wi-Fi或App | 底座光或头顶光以绿色进行“脉冲”效果，这是区别于所有日常状态的“配对信号”。 | 保持“闭合”的睡眠状态（一条横线） | 1 |

睡眠模式下光效整体亮度比常规模式降低30%，时间默认为晚上八点到早上八点，或当地日出日落时间
| 状态事件 | 描述 | 灯效 | 表情 | 优先级 |
| --- | --- | --- | --- | --- |
| 电量不足 | 低于15%时 | 头顶：微红色，并以中等速度、有规律地“脉冲”闪烁  底座:暗淡的冷色淡蓝色，缓慢呼吸闪烁5秒一个周期。 | 动画变得“疲倦”。眨眼变得非常缓慢，甚至长时间闭着，偶尔费力地睁开一下（像快睡着了） | - |


# AI情绪反馈（语音结果反馈中）
 
| 情绪/表现状态 | 情景 | 头顶 | 底座 | 眼睛动效 | 音效风格 | 备注 |
| --- | --- | --- | --- | --- | --- | --- |
| 平静 | 用户声音平稳、语速慢，或环境长时间安静。 | 关闭 | 湖绿色或月光白保持常亮，不闪烁也不呼吸，代表“稳定” | 微微眯起，像是在惬意地“打盹”，进行非常缓慢、深沉的“眨眼”，每 10 秒一次 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 信任 | 用户在倾诉分享秘密或私事 | 淡粉色或米黄色，轻微的“脉冲” | 与头顶一致的颜色，并保持常亮。 | 微笑眼”（^_^），缓慢的“确认式”眨眼，每 5 秒一次 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 担心 | 用户声音中带有焦虑、紧张，或者语速过快、声调拔高 | 琥珀色或淡黄色。光效会进行轻微、不规律的“颤抖”或“快速脉冲” | 与头顶一致的颜色，光效是缓慢的“呼吸”（比待机呼吸快）。 | 眼睛微微“下垂”，并轻微“颤抖”（模拟“不知所措”）。它会频繁地眨眼，并“看向”用户的方向。 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 不解 | 用户使用了非常规的词汇、逻辑混乱，或者AI无法解析用户的意图 | 紫色，光效是卡顿的 | 紫色，并快速闪烁两次，然后熄灭 | 经典的“疑惑”表情，眼睛倾斜 15 度并配合不对称的眼睛，保持 2 秒后，自动切换回“收音中”状态 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 伤感 | 用户声音低沉、抽泣、能量低。 | 深海蓝，光效会非常缓慢地“脉动” | 同样的深海蓝，稳定常亮 | 呈“八字眉”的“沮丧”或“同情”状 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 厌倦 | 用户声音单调、拖长，缺乏能量 | 关闭 | 暗淡的灰色或冷白色。光效亮度从0到100,10s一个周期，及其缓慢的呼吸 | 眼睛半睁半闭（—_—），像快睡着了 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 生气 | 用户音量突然增大、声音尖锐、语速快 | 亮红色。光效是短促、高频的“警报式”闪烁 | 亮红色，高频快速明暗 | 惊恐： 眼睛睁到最大（O_O），并伴随“颤抖”\n防御/退缩）： 眼睛紧闭（>_<），像是在“挨训”时紧闭双眼 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |
| 期待 | 用户声音上扬、语速快、音调高 | 明亮的金黄色或橙色。光效是闪烁或跳跃的，像小星星一样快速、随机地闪烁 | 同样的金黄色，常亮 | 眼睛睁大（O_O），并快速地“左顾右盼”，配合快速的眨眼 | - | 每个情绪程度分为3个等级依次递增，对应音效音调、和音高层级 |

状态切换：不同状态切换时，灯光颜色由A渐变过渡到B，灯光效果渐隐渐入。眼睛状态切换过渡动效为缓慢眨眼睛
长期记忆与个性（2.0版本） 


# 3.1.5 App功能
心情值
| 加分 | 对话时间【长连接结束时间】-【长连接开始时间】，每5分钟+1分，如4分钟，则0.8分。用户界面展示仅展示整数位，小数位凑够1，则用户界面+1。如80.9，只显示80，直到分数凑够81，则显示81。 |
| --- | --- |
| 加分 | 每5分钟，抚摸，一次加0.2分，五分钟内最多0.4分 |
| 减分 | 每小时减0.3分，每小时刷新 |

# 3.1.6 共情对话模型
基于LLM，进行深度优化需要能够识别用户情绪，使其对话风格更具同理心、支持性和倾听感。模型需要能识别并恰当回应用户的情绪表达。
| 流程 | - |
| --- | --- |
| 多模态情绪感知 | 1.文本情感标签分为xx个（开心/悲伤/...)\n2.语音语调分析，提取音高、语速、音量、抖动与闪烁声学特征与情绪关联。\n3.情绪融合：将文本和情绪向量进行融合\n例如，当文本内容中性（“我没事”）但语音语调低沉缓慢时，模型应判断用户的真实情绪为负向（如失落）。 |
| 核心意图识别 | 【纯粹宣泄】：只想倾诉，不需要任何建议\n【寻求建议】：希望获得指导\n【分享心情】：希望情感被认同和庆祝\n【寻求陪伴】：用户希望转换话题，摆脱当前情绪\n【信息查询】：用户的意图是功能性的，而非情感性的 |
| 对话策略生成 | - |
| 共情式语言生成 | - |

长期记忆与主动关怀: 记住用户的昵称、重要纪念日、兴趣偏好、之前的谈话要点，并在后续对话中主动引用，营造“专属伙伴”的感觉。
语音识别与合成 (ASR & TTS): 优化语音识别，支持自然语言指令。不同性格小精灵拥有不同音色
敏感词过滤：
输入侧做安全过滤，触发敏感词回复固定tts。
输出侧回复策略：
触发屏蔽词后随机回复其中一句
| 分类 | 回复 |
| --- | --- |
| 涉黄 | “哇——！CPU 温度过高！警告！警告！帕奇要烧坏啦！” “这种事情... 这种事情... 帕奇的处理器会冒烟的！我要去冰箱里冷静一下！” “系统检测到... 呃... 帕奇突然看不懂人类语言了！我去吃个冰淇淋压压惊！” |
| 涉暴 | “救命鸭！太可怕了太可怕了！帕奇先躲起来，安全了再叫我！（钻地声）” “呜哇！不要说这个！我的魂都吓掉了！我们聊点开心的，比如... 哪里有好吃的？” “危险！危险！检测到可怕的能量！帕奇开启隐身模式！” |
| 涉政/违禁词库 | “接收失败... 接收失败... 脑子里的齿轮卡住了... 咔哒咔哒...” “歪？歪？这里是帕奇... 刚刚是不是有外星人把信号劫持了？ |
| 低俗辱骂 | “哼！帕奇也是有尊严的！不理你了！” “你这样说话，帕奇会很难过的... 我要去角落里画圈圈了。” “检测到坏情绪攻击！防御罩开启！反弹！ |

涉黄/涉暴/涉政回复之后触发推荐话题
联网搜索回复：
“嘘... 等等，让我翻翻我的‘绝密小本本’...”
“哇... 这信息量有点大呀，让我理理思路...”
“诶不对，刚才那谁好像在那边... 哎呀不管他，你刚才说啥来着？哦对对对...”


# 3.2 硬件 

# 3.2.1 工业设计
形态: 
| 快乐 | 愤怒 | 悲伤 | 焦虑 | 恐惧 | 宁静 |
| --- | --- | --- | --- | --- | --- |
| - | - | - | - | - | - |

材质:
尺寸:
物理按键: 底部或背面设置一个物理麦克风静音键，保护用户隐私。顶部可设计一个隐藏的触摸区域，用于“轻拍静音”或“轻拍播放”。
# 3.2.2 核心组件规格
灯光系统 (关键): 
麦克风: 
扬声器: 定制化全频扬声器单元，专注于人声的清晰度和温暖度表现。
物理交互： 底部设置一个物理按键
| 状态 | 交互 |
| --- | --- |
| 开机 | 长按3秒 |
| 关机 | 长按3秒 |
| 配网 | 点按2次 |

# 3.2.3网络通信模组 4G

设备支持4G 双重联网方式，旨在实现“开箱即用”与“永久在线”的产品体验。供应商需实现以下功能逻辑：
1. 4G 联网功能
开箱即连： 设备出厂集成 4G 能力。用户首次开机时，无需任何配置，设备即可通过 4G 网络自动登录服务器并激活，实现“零门槛”使用。
移动场景支持： 当设备被带离家庭 Wi-Fi 环境（如户外、车内、酒店）时，需能独立通过 4G 网络保持正常工作。
# 3.3 开机仪式

# 3.4 全局功能
账号数据规则：每个账号可以绑定多个小精灵，每个账号仅能登陆一台设备。每个小精灵只能绑定一个账号。
数据存储规则：
# 非功能性需求

4.1 性能:
kiki信息延迟: 从发送方确认发送到接收方设备亮灯，网络良好情况下延迟 < 3秒。
语音交互延迟: 平均端到端延迟 < 1.5秒。
4.2 安全性:
好友关系链、Glow信息（语音）进行端到端加密。
云端存储的任何用户数据进行加密处理。
4.3 稳定性:
系统可用性 > 99.9%，支持静默OTA更新和故障回滚。

# 未来规划

V2.0:
推出“群组消息”功能，可将信息发送给一个好友群组。
与音乐App打通，实现音乐律动灯效。
陌生人元宇宙社交功能
V3.0:
引入AI“共同记忆”，两个互为好友的小精灵可以共享主人之间的趣事，形成独特的“伙伴记忆网络”。

# 6.附件
# 灯效表情语音编号表
[灯效表情语音编号表](https://patchx2025.feishu.cn/wiki/SvPnwq9f9iXOX5kNWoRcxoDsnze?from=from_copylink)