#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å¤šè¡Œä¸šAIè¯æœ¯ç”Ÿæˆè„šæœ¬ v2.0
ä¸ºæ¯ä¸ªåœºæ™¯ç”Ÿæˆä¸åŒè¡Œä¸šçš„å”¯ä¸€è¯æœ¯ï¼Œè¦†ç›–é¤é¥®ã€åŒ»ç–—ã€æ•™è‚²ã€é›¶å”®ã€é‡‘èã€æ—…æ¸¸ã€æˆ¿äº§ã€äº¤é€šç­‰
"""

import csv
import json
from datetime import datetime
from pathlib import Path


class MultiIndustryScriptGenerator:
    """å¤šè¡Œä¸šAIè¯æœ¯ç”Ÿæˆå™¨"""
    
    def __init__(self, csv_file_path: str):
        self.csv_file_path = Path(csv_file_path)
        self.scenario_data = []
        self.generated_scripts = set()
    
    def load_csv_data(self) -> bool:
        """åŠ è½½CSVæ•°æ®"""
        try:
            with open(self.csv_file_path, 'r', encoding='utf-8') as f:
                reader = csv.DictReader(f)
                for row in reader:
                    self.scenario_data.append(row)
            print(f"âœ… æˆåŠŸåŠ è½½ {len(self.scenario_data)} æ¡æµ‹è¯•æ•°æ®")
            return True
        except Exception as e:
            print(f"âŒ åŠ è½½CSVå¤±è´¥: {e}")
            return False
    
    def generate_unique_script(self, scenario_id: str, scenario_name: str) -> str:
        """ä¸ºæ¯ä¸ªåœºæ™¯ç”Ÿæˆä¸åŒè¡Œä¸šçš„å”¯ä¸€è¯æœ¯"""
        
        # å¤šè¡Œä¸šè¯æœ¯åº“ - æ¯ä¸ªåœºæ™¯å¯¹åº”ä¸åŒè¡Œä¸š
        scripts = {
            # SC001 - SC010: æ­£å¸¸æ— åœé¡¿ã€çŸ­å¥ã€é•¿å¥ã€é—®å¥ã€æ„Ÿå¹å¥
            "SC001": "è¿™å®¶é¤å…çš„èœå“å‘³é“å¾ˆä¸é”™",  # é¤é¥®è¡Œä¸š
            "SC002": "æ‚¨å¥½ï¼Œæ¬¢è¿å…‰ä¸´ï¼",  # é›¶å”®è¡Œä¸š
            "SC003": "è¿™ä¸ªæ²»ç–—æ–¹æ¡ˆéœ€è¦æŒç»­è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬ä¼šå®šæœŸè·Ÿè¿›æ‚¨çš„ç—…æƒ…ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC004": "æ‚¨é¢„çº¦çš„èˆªç­æ˜¯æ˜å¤©ä¸Šåˆåç‚¹å—ï¼Ÿ",  # æ—…æ¸¸è¡Œä¸š
            "SC005": "å“‡ï¼Œè¿™ä¸ªæˆ·å‹è®¾è®¡çœŸä¸é”™ï¼",  # æˆ¿äº§è¡Œä¸š
            "SC006": "è¿™ä¸ªç†è´¢äº§å“æ”¶ç›Šæ¯”è¾ƒç¨³å®š",  # é‡‘èè¡Œä¸š
            "SC007": "è€å¸ˆï¼Œè¿™é“é¢˜æˆ‘ä¸å¤ªç†è§£",  # æ•™è‚²è¡Œä¸š
            "SC008": "è¿™ä¸ªè·¯å£çš„äº¤é€šä¿¡å·ç¯éœ€è¦è°ƒæ•´ä¸€ä¸‹",  # äº¤é€šè¡Œä¸š
            "SC009": "æ‚¨çš„å¿«é€’å¤§æ¦‚ä»€ä¹ˆæ—¶å€™èƒ½é€åˆ°ï¼Ÿ",  # ç‰©æµè¡Œä¸š
            "SC010": "å“¦ï¼ŒåŸæ¥æ˜¯è¿™æ ·ï¼",  # å®¢æœè¡Œä¸š
            
            # SC011 - SC020: å„ç§åœé¡¿ç±»å‹
            "SC011": "å—¯...è¿™ä¸ªèœå•è®¾è®¡å¾—æŒºæ¸…æ¥šçš„ã€‚",  # é¤é¥®è¡Œä¸š
            "SC012": "é‚£ä¸ª...è¿™ä¸ªè¯å“è¯´æ˜ä¹¦æœ‰ç‚¹é—®é¢˜ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC013": "å—¯...è¿™ä¸ªæ•™å­¦å¤§çº²æŒºå…¨é¢çš„ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC014": "é‚£ä¸ª...è¿™ä¸ªå•†å“æ ‡ç­¾éœ€è¦æ›´æ–°ä¸€ä¸‹ã€‚",  # é›¶å”®è¡Œä¸š
            "SC015": "å—¯...é‚£ä¸ª...è¿™ä¸ªæŠ•èµ„ç»„åˆæŒºåˆç†çš„ã€‚",  # é‡‘èè¡Œä¸š
            "SC016": "å—¯...ä»Šå¤©çš„æ—…æ¸¸å›¢è¡Œç¨‹å®‰æ’å¾—æŒºé¡ºåˆ©ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC017": "é‚£ä¸ª...è¿™ä¸ªæˆ¿å±‹ç»´ä¿®å¾—æŒºå¿«ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC018": "å—¯...é‚£ä¸ª...è¿™ä¸ªèˆªç­èµ·é£å¾ˆå‡†æ—¶ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC019": "è¿™ä¸ªè·¯å£...å—¯...æœ‰ç‚¹æ‹¥å µã€‚",  # äº¤é€šè¡Œä¸š
            "SC020": "è¿™ä¸ªå¿«é€’...é‚£ä¸ª...é€å¾—æŒºå¿«ã€‚",  # ç‰©æµè¡Œä¸š
            
            # SC021 - SC030: å„ç§åœé¡¿ç±»å‹ç»§ç»­
            "SC021": "è¿™ä¸ªè®¢å•...å—¯...é‚£ä¸ª...å¤„ç†å¾—æŒºä»”ç»†ã€‚",  # é›¶å”®è¡Œä¸š
            "SC022": "è¿™ä¸ªè¯¾ç¨‹ä¸Šçº¿äº†...å—¯ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC023": "è¿™ä¸ªæ‰‹æœ¯å®Œæˆäº†...é‚£ä¸ª...ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC024": "è¿™ä¸ªè´·æ¬¾å®¡æ‰¹é€šè¿‡äº†...å—¯...é‚£ä¸ª...ã€‚",  # é‡‘èè¡Œä¸š
            "SC025": "å—¯...è¿™ä¸ªæ™¯ç‚¹æŒºé‡è¦ï¼Œå’±ä»¬ä¸€èµ·çœ‹çœ‹ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC026": "è¿™ä¸ªæˆ¿é—´è£…ä¿®å¾—å¾ˆæ¼‚äº®",  # æˆ¿äº§è¡Œä¸š
            "SC027": "å¥½ä¹…ä¸è§ï¼Œæœ€è¿‘èº«ä½“æ€ä¹ˆæ ·ï¼Ÿ",  # åŒ»ç–—è¡Œä¸š
            "SC028": "è¿™ä¸ªæ•™å­¦è®¡åˆ’éœ€è¦è¡¥å……ä¸€äº›å®è·µç¯èŠ‚ï¼Œå’±ä»¬ä¸€èµ·æƒ³æƒ³ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC029": "è¿™ä¸ªäº¤é€šäº‹æ•…æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿ",  # äº¤é€šè¡Œä¸š
            "SC030": "å¤©å“ªï¼Œè¿™ä¹ˆå¿«å°±åˆ°ç›®çš„åœ°äº†ï¼",  # æ—…æ¸¸è¡Œä¸š
            
            # SC031 - SC040: æ›´å¤šåœºæ™¯
            "SC031": "è¿™ä¸ªèœå“å†™å¾—å¾ˆè¯¦ç»†",  # é¤é¥®è¡Œä¸š
            "SC032": "å–‚ï¼Œèƒ½å¬åˆ°æˆ‘è¯´è¯å—ï¼Ÿ",  # å®¢æœè¡Œä¸š
            "SC033": "è¿™ä¸ªç—…å†éœ€è¦æ›´æ–°ä¸€ä¸‹ï¼Œå’±ä»¬ä¸€èµ·æ•´ç†æ•´ç†ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC034": "å’±ä»¬éœ€è¦å¤šä¹…æ‰èƒ½å…¥ä½ï¼Ÿ",  # æˆ¿äº§è¡Œä¸š
            "SC035": "å“‡å¡ï¼Œè¿™ä¸ªæ™¯ç‚¹çœŸä¸é”™ï¼",  # æ—…æ¸¸è¡Œä¸š
            "SC036": "è¿™ä¸ªè´¦æˆ·ä½™é¢æ˜¾ç¤ºå¾—å¾ˆå‡†ç¡®",  # é‡‘èè¡Œä¸š
            "SC037": "å“ï¼Œä½ åœ¨å—ï¼Ÿ",  # å®¢æœè¡Œä¸š
            "SC038": "è¿™ä¸ªå•†å“ä¸Šæ¶åé”€é‡æŒºå¥½çš„ï¼Œå’±ä»¬è€ƒè™‘ä¸€ä¸‹åç»­çš„ä¿ƒé”€ã€‚",  # é›¶å”®è¡Œä¸š
            "SC039": "å’±ä»¬éœ€è¦å¤šå°‘é¢„ç®—æ¥å®Œæˆè¿™ä¸ªé¡¹ç›®ï¼Ÿ",  # é‡‘èè¡Œä¸š
            "SC040": "å“å‘€ï¼Œè¿™ä¸ªè·¯å†µé—®é¢˜è§£å†³äº†ï¼",  # äº¤é€šè¡Œä¸š
            
            # SC041 - SC050: æ›´å¤šåœºæ™¯
            "SC041": "è¿™ä¸ªé¤å…è£…ä¿®å¾—å¾ˆç¾è§‚",  # é¤é¥®è¡Œä¸š
            "SC042": "å—¨ï¼Œæ—©ä¸Šå¥½ï¼",  # å®¢æœè¡Œä¸š
            "SC043": "è¿™ä¸ªæˆ¿é—´å¸ƒå±€å¯ä»¥å†è°ƒæ•´ä¸€ä¸‹ï¼Œæå‡å±…ä½ä½“éªŒã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC044": "è¿™ä¸ªè€ƒè¯•æˆç»©ç¬¦åˆé¢„æœŸå—ï¼Ÿ",  # æ•™è‚²è¡Œä¸š
            "SC045": "å¤ªæ£’äº†ï¼Œç»ˆäºæ‹¿åˆ°é©¾ç…§äº†ï¼",  # äº¤é€šè¡Œä¸š
            "SC046": "è¿™ä¸ªè´­ç‰©ä½“éªŒåšå¾—å¾ˆæµç•…",  # é›¶å”®è¡Œä¸š
            "SC047": "å—¯ï¼Œæˆ‘çŸ¥é“äº†ã€‚",  # å®¢æœè¡Œä¸š
            "SC048": "è¿™ä¸ªåŸºé‡‘æ”¶ç›Šè¿˜å¯ä»¥å†æå‡ï¼Œå’±ä»¬ä¸€èµ·åˆ†æåˆ†æã€‚",  # é‡‘èè¡Œä¸š
            "SC049": "å¤ªå¥½äº†ï¼Œæ‰‹æœ¯æˆåŠŸäº†ï¼",  # åŒ»ç–—è¡Œä¸š
            "SC050": "è¿™ä¸ªèœå“å£å‘³å¾ˆåˆ°ä½",  # é¤é¥®è¡Œä¸š
            
            # SC051 - SC060: è¯­æ°”é£æ ¼æµ‹è¯•
            "SC051": "å¥½çš„ï¼Œæ²¡é—®é¢˜ã€‚",  # å®¢æœè¡Œä¸š
            "SC052": "è¿™ä¸ªåŸå¸‚äº¤é€šå¯ä»¥å†æ”¹è¿›ä¸€ä¸‹ï¼Œæé«˜é€šè¡Œæ•ˆç‡ã€‚",  # äº¤é€šè¡Œä¸š
            "SC053": "å“‡ï¼Œè¿™ä¸ªæ™¯ç‚¹é£æ™¯çœŸç¾ï¼",  # æ—…æ¸¸è¡Œä¸š
            "SC054": "è¿™ä¸ªå°åŒºç¯å¢ƒè®¾è®¡å¾—å¾ˆæ¸…æ™°",  # æˆ¿äº§è¡Œä¸š
            "SC055": "è¡Œï¼Œé‚£å°±è¿™æ ·å§ã€‚",  # å®¢æœè¡Œä¸š
            "SC056": "è¿™ä¸ªç‚¹é¤æµç¨‹å¯ä»¥å†ç®€åŒ–ä¸€ä¸‹ï¼Œæé«˜ç”¨é¤æ•ˆç‡ã€‚",  # é¤é¥®è¡Œä¸š
            "SC057": "å“å‘€ï¼Œè¿™ä¸ªè£…ä¿®çœŸå¥½çœ‹ï¼",  # æˆ¿äº§è¡Œä¸š
            "SC058": "å—¯...è¿™ä¸ªè¯¾ç¨‹å®‰æ’å¾—æŒºåˆç†ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC059": "é‚£ä¸ª...è¿™ä¸ªæ²»ç–—æ–¹æ¡ˆæœ‰ç‚¹å¤æ‚ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC060": "å—¯...è¿™ä¸ªå•†å“åŒ…è£…è€ƒè™‘å¾—æŒºå‘¨å…¨ã€‚",  # é›¶å”®è¡Œä¸š
            
            # SC061 - SC070: æ›´å¤šè¯­æ°”å’Œåœé¡¿æµ‹è¯•
            "SC061": "å¤ªæ£’äº†ï¼Œå®¢æˆ·åé¦ˆå¾ˆå¥½ï¼",  # é›¶å”®è¡Œä¸š
            "SC062": "é‚£ä¸ª...è¿™ä¸ªæ™¯ç‚¹è®¾æ–½æœ‰ç‚¹ä¸è¶³ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC063": "å—¯...è¿™ä¸ªç—…å†å†™å¾—æŒºè¯¦ç»†ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC064": "é‚£ä¸ª...è¿™ä¸ªæ•™å­¦è®¡åˆ’æœ‰ç‚¹é—æ¼ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC065": "å—¯...é‚£ä¸ª...è¿™ä¸ªæŠ•èµ„å›æŠ¥æŒºé«˜æ•ˆçš„ã€‚",  # é‡‘èè¡Œä¸š
            "SC066": "å—¯...ä»Šå¤©çš„èˆªç­é£å¾—æŒºé¡ºåˆ©ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC067": "é‚£ä¸ª...è¿™ä¸ªèœå“æœ‰ç‚¹ç®€ç•¥ã€‚",  # é¤é¥®è¡Œä¸š
            "SC068": "å—¯...è¿™ä¸ªæˆ¿é—´è®¾è®¡å¾—æŒºåˆç†ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC069": "é‚£ä¸ª...è¿™ä¸ªå•†å“åº“å­˜éœ€è¦è°ƒæ•´ä¸€ä¸‹ã€‚",  # é›¶å”®è¡Œä¸š
            "SC070": "å—¯...é‚£ä¸ª...è¿™ä¸ªä¿é™©ç†èµ”æŒºå®Œå–„çš„ã€‚",  # é‡‘èè¡Œä¸š
            
            # SC071 - SC080: æ›´å¤šåœºæ™¯
            "SC071": "å—¯...ä»Šå¤©çš„æ‰‹æœ¯åšå¾—æŒºé¡ºåˆ©ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC072": "é‚£ä¸ª...è¿™ä¸ªæˆ¿å±‹éœ€è¦æ”¹è¿›ä¸€ä¸‹ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC073": "å—¯...è¿™ä¸ªé¤å…è£…ä¿®å¾—æŒºç¾è§‚ã€‚",  # é¤é¥®è¡Œä¸š
            "SC074": "é‚£ä¸ª...è¿™ä¸ªè´­ç‰©ä½“éªŒéœ€è¦ä¼˜åŒ–ä¸€ä¸‹ã€‚",  # é›¶å”®è¡Œä¸š
            "SC075": "å—¯...é‚£ä¸ª...è¿™ä¸ªé“¶è¡ŒæœåŠ¡æŒºæœ‰æ•ˆçš„ã€‚",  # é‡‘èè¡Œä¸š
            "SC076": "å—¯...ä»Šå¤©çš„è¯¾ç¨‹è®²å¾—æŒºé¡ºåˆ©ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC077": "é‚£ä¸ª...è¿™ä¸ªæ™¯ç‚¹äº¤é€šéœ€è¦æå‡ä¸€ä¸‹ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC078": "å—¯...è¿™ä¸ªç‰©æµé…é€åšå¾—æŒºæµç•…ã€‚",  # ç‰©æµè¡Œä¸š
            "SC079": "é‚£ä¸ª...è¿™ä¸ªåŸå¸‚è§„åˆ’éœ€è¦é‡æ„ä¸€ä¸‹ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC080": "å—¯...é‚£ä¸ª...è¿™ä¸ªé…’åº—æœåŠ¡æŒºåˆ›æ–°çš„ã€‚",  # æ—…æ¸¸è¡Œä¸š
            
            # SC081 - SC090: æ›´å¤šåœºæ™¯
            "SC081": "å—¯...ä»Šå¤©çš„å¿«é€’é€å¾—æŒºé¡ºåˆ©ã€‚",  # ç‰©æµè¡Œä¸š
            "SC082": "é‚£ä¸ª...è¿™ä¸ªè¯¾ç¨‹å¼€å‘å¾—æŒºå¿«ã€‚",  # æ•™è‚²è¡Œä¸š
            "SC083": "å—¯...è¿™ä¸ªèœå“å£å‘³æŒºåˆ°ä½ã€‚",  # é¤é¥®è¡Œä¸š
            "SC084": "é‚£ä¸ª...è¿™ä¸ªæˆ¿å±‹é”€å”®å¾—æŒºå¿«ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC085": "å—¯...é‚£ä¸ª...è¿™ä¸ªæ™¯åŒºç®¡ç†æŒºäººæ€§åŒ–çš„ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC086": "å—¯...ä»Šå¤©çš„äº¤é€šç®¡åˆ¶æŒºé¡ºåˆ©ã€‚",  # äº¤é€šè¡Œä¸š
            "SC087": "é‚£ä¸ª...è¿™ä¸ªèˆªç­ä¼˜åŒ–å¾—æŒºå¿«ã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC088": "å—¯...è¿™ä¸ªé“¶è¡Œç³»ç»ŸæŒºæ¸…æ™°ã€‚",  # é‡‘èè¡Œä¸š
            "SC089": "é‚£ä¸ª...è¿™ä¸ªå¿«é€’æ—¶æ•ˆæŒºå¿«ã€‚",  # ç‰©æµè¡Œä¸š
            "SC090": "å—¯...é‚£ä¸ª...è¿™ä¸ªé…’åº—é¢„è®¢æµç¨‹æŒºé¡ºç•…çš„ã€‚",  # æ—…æ¸¸è¡Œä¸š
            
            # SC091 - SC100: æ›´å¤šåœºæ™¯
            "SC091": "å—¯...è¿™ä¸ªé¤å…æœåŠ¡å¾—æŒºé¡ºåˆ©ã€‚",  # é¤é¥®è¡Œä¸š
            "SC092": "é‚£ä¸ª...è¿™ä¸ªæˆ¿äº§äº¤æ˜“å¾—æŒºå¿«ã€‚",  # æˆ¿äº§è¡Œä¸š
            "SC093": "å—¯...è¿™ä¸ªåŒ»ç–—æ£€æŸ¥å¾—æŒºé¡ºåˆ©ã€‚",  # åŒ»ç–—è¡Œä¸š
            "SC094": "é‚£ä¸ª...è¿™ä¸ªæ•™è‚²åŸ¹è®­å¾ˆæˆåŠŸã€‚",  # æ•™è‚²è¡Œä¸š
            "SC095": "å—¯...é‚£ä¸ª...è¿™ä¸ªé›¶å”®ä¿ƒé”€å¾ˆå…¨é¢ã€‚",  # é›¶å”®è¡Œä¸š
            "SC096": "å—¯...è¿™ä¸ªé‡‘èæŠ•èµ„å¾—æŒºé¡ºåˆ©ã€‚",  # é‡‘èè¡Œä¸š
            "SC097": "é‚£ä¸ª...è¿™ä¸ªæ—…æ¸¸ä½“éªŒå¾ˆæˆåŠŸã€‚",  # æ—…æ¸¸è¡Œä¸š
            "SC098": "å—¯...è¿™ä¸ªç‰©æµé…é€æŒºé¡ºåˆ©ã€‚",  # ç‰©æµè¡Œä¸š
            "SC099": "é‚£ä¸ª...è¿™ä¸ªäº¤é€šç®¡ç†å¾ˆæˆåŠŸã€‚",  # äº¤é€šè¡Œä¸š
            "SC100": "å—¯...é‚£ä¸ª...è¿™ä¸ªå®¢æœæœåŠ¡æŒºä¸°å¯Œçš„ã€‚",  # å®¢æœè¡Œä¸š
        }
        
        script = scripts.get(scenario_id, f"è¿™ä¸ªæµ‹è¯•åœºæ™¯ {scenario_id} çš„è¯æœ¯")
        return script
    
    def generate_modifications(self) -> list:
        """ç”Ÿæˆä¿®æ”¹åˆ—è¡¨"""
        modifications = []
        
        for scenario in self.scenario_data:
            scenario_id = scenario.get('scenario_id', '')
            scenario_name = scenario.get('scenario_name', '')
            old_text = scenario.get('text', '')
            
            # ç”Ÿæˆæ–°çš„è¯æœ¯
            new_text = self.generate_unique_script(scenario_id, scenario_name)
            
            # ç¡®ä¿è¯æœ¯å”¯ä¸€
            while new_text in self.generated_scripts:
                new_text = self.generate_unique_script(scenario_id, scenario_name)
            
            self.generated_scripts.add(new_text)
            
            modification = {
                "scenario_id": scenario_id,
                "scenario_name": scenario_name,
                "old_text": old_text,
                "new_text": new_text,
                "reason": f"AIæ‰‹åŠ¨ç”Ÿæˆï¼š{scenario_name}åœºæ™¯çš„{self.get_industry(scenario_id)}è¡Œä¸šè¯æœ¯"
            }
            
            modifications.append(modification)
        
        return modifications
    
    def get_industry(self, scenario_id: str) -> str:
        """è·å–åœºæ™¯å¯¹åº”çš„è¡Œä¸š"""
        industry_map = {
            "SC001": "é¤é¥®", "SC002": "é›¶å”®", "SC003": "åŒ»ç–—", "SC004": "æ—…æ¸¸", "SC005": "æˆ¿äº§",
            "SC006": "é‡‘è", "SC007": "æ•™è‚²", "SC008": "äº¤é€š", "SC009": "ç‰©æµ", "SC010": "å®¢æœ",
            "SC011": "é¤é¥®", "SC012": "åŒ»ç–—", "SC013": "æ•™è‚²", "SC014": "é›¶å”®", "SC015": "é‡‘è",
            "SC016": "æ—…æ¸¸", "SC017": "æˆ¿äº§", "SC018": "æ—…æ¸¸", "SC019": "äº¤é€š", "SC020": "ç‰©æµ",
            "SC021": "é›¶å”®", "SC022": "æ•™è‚²", "SC023": "åŒ»ç–—", "SC024": "é‡‘è", "SC025": "æ—…æ¸¸",
            "SC026": "æˆ¿äº§", "SC027": "åŒ»ç–—", "SC028": "æ•™è‚²", "SC029": "äº¤é€š", "SC030": "æ—…æ¸¸",
            "SC031": "é¤é¥®", "SC032": "å®¢æœ", "SC033": "åŒ»ç–—", "SC034": "æˆ¿äº§", "SC035": "æ—…æ¸¸",
            "SC036": "é‡‘è", "SC037": "å®¢æœ", "SC038": "é›¶å”®", "SC039": "é‡‘è", "SC040": "äº¤é€š",
            "SC041": "é¤é¥®", "SC042": "å®¢æœ", "SC043": "æˆ¿äº§", "SC044": "æ•™è‚²", "SC045": "äº¤é€š",
            "SC046": "é›¶å”®", "SC047": "å®¢æœ", "SC048": "é‡‘è", "SC049": "åŒ»ç–—", "SC050": "é¤é¥®",
            "SC051": "å®¢æœ", "SC052": "äº¤é€š", "SC053": "æ—…æ¸¸", "SC054": "æˆ¿äº§", "SC055": "å®¢æœ",
            "SC056": "é¤é¥®", "SC057": "æˆ¿äº§", "SC058": "æ•™è‚²", "SC059": "åŒ»ç–—", "SC060": "é›¶å”®",
            "SC061": "é›¶å”®", "SC062": "æ—…æ¸¸", "SC063": "åŒ»ç–—", "SC064": "æ•™è‚²", "SC065": "é‡‘è",
            "SC066": "æ—…æ¸¸", "SC067": "é¤é¥®", "SC068": "æˆ¿äº§", "SC069": "é›¶å”®", "SC070": "é‡‘è",
            "SC071": "åŒ»ç–—", "SC072": "æˆ¿äº§", "SC073": "é¤é¥®", "SC074": "é›¶å”®", "SC075": "é‡‘è",
            "SC076": "æ•™è‚²", "SC077": "æ—…æ¸¸", "SC078": "ç‰©æµ", "SC079": "æˆ¿äº§", "SC080": "æ—…æ¸¸",
            "SC081": "ç‰©æµ", "SC082": "æ•™è‚²", "SC083": "é¤é¥®", "SC084": "æˆ¿äº§", "SC085": "æ—…æ¸¸",
            "SC086": "äº¤é€š", "SC087": "æ—…æ¸¸", "SC088": "é‡‘è", "SC089": "ç‰©æµ", "SC090": "æ—…æ¸¸",
            "SC091": "é¤é¥®", "SC092": "æˆ¿äº§", "SC093": "åŒ»ç–—", "SC094": "æ•™è‚²", "SC095": "é›¶å”®",
            "SC096": "é‡‘è", "SC097": "æ—…æ¸¸", "SC098": "ç‰©æµ", "SC099": "äº¤é€š", "SC100": "å®¢æœ"
        }
        return industry_map.get(scenario_id, "é€šç”¨")
    
    def save_to_json(self, modifications: list, output_file: str) -> bool:
        """ä¿å­˜åˆ°JSONæ–‡ä»¶"""
        try:
            data = {
                "version": "v7.0",
                "description": "å¤šè¡Œä¸šAIæ‰‹åŠ¨ç”Ÿæˆè¯æœ¯ - è¦†ç›–é¤é¥®ã€åŒ»ç–—ã€æ•™è‚²ã€é›¶å”®ã€é‡‘èã€æ—…æ¸¸ã€æˆ¿äº§ã€äº¤é€šã€ç‰©æµã€å®¢æœç­‰10ä¸ªè¡Œä¸š",
                "modified_date": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                "total_modifications": len(modifications),
                "industries_covered": ["é¤é¥®", "åŒ»ç–—", "æ•™è‚²", "é›¶å”®", "é‡‘è", "æ—…æ¸¸", "æˆ¿äº§", "äº¤é€š", "ç‰©æµ", "å®¢æœ"],
                "modifications": modifications
            }
            
            with open(output_file, 'w', encoding='utf-8') as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
            
            print(f"âœ… æˆåŠŸä¿å­˜ä¿®æ”¹æ–‡ä»¶: {output_file}")
            print(f"   æ€»ä¿®æ”¹æ•°: {len(modifications)}")
            print(f"   è¦†ç›–è¡Œä¸š: {len(data['industries_covered'])}ä¸ª")
            return True
        except Exception as e:
            print(f"âŒ ä¿å­˜JSONå¤±è´¥: {e}")
            return False


def main():
    """ä¸»å‡½æ•°"""
    print("=" * 80)
    print("å¤šè¡Œä¸šAIè¯æœ¯ç”Ÿæˆå™¨ v2.0")
    print("=" * 80)
    
    # åˆå§‹åŒ–ç”Ÿæˆå™¨
    csv_file = "vad_test_data_noise_comparison.csv"
    json_output = "text_modifications_v7.0.json"
    
    generator = MultiIndustryScriptGenerator(csv_file)
    
    # åŠ è½½æ•°æ®
    if not generator.load_csv_data():
        return
    
    # ç”Ÿæˆä¿®æ”¹
    print("\nğŸ”„ å¼€å§‹ç”Ÿæˆå¤šè¡Œä¸šè¯æœ¯...")
    modifications = generator.generate_modifications()
    print(f"âœ… æˆåŠŸç”Ÿæˆ {len(modifications)} æ¡ä¿®æ”¹")
    
    # ä¿å­˜åˆ°JSON
    if generator.save_to_json(modifications, json_output):
        print("\n" + "=" * 80)
        print("âœ… å¤šè¡Œä¸šè¯æœ¯ç”Ÿæˆå®Œæˆï¼")
        print("=" * 80)
        
        # æ˜¾ç¤ºè¡Œä¸šåˆ†å¸ƒ
        industry_count = {}
        for mod in modifications:
            industry = mod['reason'].split('ï¼š')[1].split('è¡Œä¸š')[0]
            industry_count[industry] = industry_count.get(industry, 0) + 1
        
        print("\nğŸ“Š è¡Œä¸šåˆ†å¸ƒ:")
        for industry, count in sorted(industry_count.items()):
            print(f"   {industry}: {count}æ¡")


if __name__ == "__main__":
    main()
