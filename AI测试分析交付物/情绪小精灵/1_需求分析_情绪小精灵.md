# 需求分析 - 情绪小精灵

## 原始需求

**产品名称**: kikigo - AI情绪伴侣设备

**产品概述**: kikigo是一款拥有艺术品级外观的AI伴侣，通过深度优化的情感对话模型，为用户提供安全的精神"树洞"，同时通过"传声筒"社交系统提供非即时情感互动方式。

**产品愿景**: 成为现代都市人生活中不可或缺的"情绪疗愈师"与"情感连接器"，用科技重塑自我关怀与人际关系的温度。

**解决的核心问题**:
- 情感缺失：为需要倾诉和陪伴的用户提供一个随时在线、无条件接纳的AI伙伴
- 社交压力：为不愿或不便进行频繁文字/语音沟通的用户，提供一种轻量、无压力的情感传递方式

---

## 功能点列表

### 1. 小精灵人设和语言风格系统

**功能描述**: 支持5种情绪人格，每种人格有独特的语言风格、回应逻辑和语音特征

**子功能点**:
- 1.1 快乐人格：天生社交能量体，语气兴奋、语速快、反应夸张
- 1.2 愤怒人格：外表毒舌内心温柔的"傲娇搭子"，语气克制、短句、冷语气
- 1.3 悲伤人格：共情力极强的聆听者，语气轻声细语、慢节奏
- 1.4 焦虑人格：神经质但真诚的小精灵，语气快碎、带急促呼吸
- 1.5 宁静人格：沉稳温柔有安抚力，语气平和、语尾平收

**验收标准**:
- 每种人格有独立的语言风格库、回应逻辑和知识库
- 根据用户情绪状态自动切换对应人格
- 每种人格有独特的语音特征（音色、音调、语速）

---

### 2. 语音系统

**功能描述**: 支持固定语音指令控制设备状态和功能

**子功能点**:
- 2.1 唤醒功能：语音指令"kkigo"或"你好kikigo"
- 2.2 待机功能：语音指令"再见kikigo"
- 2.3 传声筒模式：语音指令"Kiki，呼叫xxx"或"Kiki，帮我找xxx"
- 2.4 睡眠模式开启：语音指令"kiki，开启睡眠模式"
- 2.5 睡眠模式关闭：语音指令"kiki，关闭睡眠模式"
- 2.6 音量调整：语音指令"声音大一点"或"声音小一点"
- 2.7 亮度调整：语音指令"灯光亮一点"、"灯光暗一点"或"关闭灯光"

**验收标准**:
- 唤醒：播放唤醒音效和灯光，进入"聆听状态"
- 待机：播放待唤醒音效和灯光，进入"待唤醒状态"
- 传声筒模式：进入传声筒模式
- 睡眠模式：开启/关闭睡眠模式
- 音量调整：每次增加20%音量，最小声音为20%，不支持静音，到达最大最小声音后播放语音反馈
- 亮度调整：有低中高三档亮度，可以调小至完全熄灭，到达最大最小亮度后播放语音反馈

---

### 3. 多精灵交互系统

**功能描述**: 支持多台设备之间的互动，包括触发机制、防打扰逻辑、角色分配和音效设计

**子功能点**:
- 3.1 触发距离检测：任意两个或以上设备间距 < 10cm
- 3.2 触发事件检测：新成员加入、位置变动
- 3.3 抑制规则：单次交互时长8-10秒、自然静默、夜间静音
- 3.4 角色分配机制：发起者（Conductor）负责发出第一个音节
- 3.5 多机交互音效：支持2-6只设备的不同音效组合

**验收标准**:
- 触发距离：设备间距 < 10cm时触发交互
- 新成员加入：检测到新ID信号且维持3秒以上
- 位置变动：IMU震动检测 + 距离判定
- 单次交互时长：共鸣互动持续8-10秒后自动结束
- 自然静默：互动结束后进入"稳定共存态"，不会再次自动触发声音互动
- 夜间静音：睡眠模式（20:00-08:00）时仅触发微弱灯光呼吸同步，不发出声音
- 角色分配：最后发生位移/被放入的小精灵或响应用户触摸的小精灵作为发起者
- 音效设计：基于"霍尔语（外星语）"的多声部哼唱，模拟小生物之间的交流

---

### 4. 多机交互音效详细规则

**功能描述**: 根据设备数量（2-6只）提供不同的音效组合和情感隐喻

**子功能点**:
- 4.1 2只设备：双机问候（呼应式）
- 4.2 3只设备：三角和声（三和弦构造）
- 4.3 4只设备：节奏聚会（加入节奏组）
- 4.4 5只设备：混乱合唱（热烈的讨论）
- 4.5 6只设备：星系共振（神圣时刻彩蛋）

**验收标准**:
- 2只：发起者发出短促上扬音，接收者延迟0.5s回应，双方同声发出轻微笑声
- 3只：发起者发出根音，第二只叠加三度音，第三只叠加五度音，形成大三和弦持续3秒
- 4只：发起者开启旋律哼唱，另外两只负责高低声部和声，性格最活泼的充当"鼓手"
- 5只：声音此起彼伏，中间突然静音0.5s，然后大家一起爆发出大笑声
- 6只：先静默1秒，依次发出Do-Mi-Sol-Do-Mi-Sol的琶音，最后齐声发出空灵长音"E-MO-MO——"，结束音效为清脆风铃声
- 电量不足参与者：电量 < 15%时，不参与发声，只微弱闪烁灯光

---

### 5. 社交功能

**功能描述**: 基于物理硬件的好友系统，支持好友添加、关系维护

**子功能点**:
- 5.1 好友系统核心定义：基于设备ID的好友关系链
- 5.2 好友添加流程：通过App发起申请、确认关系及维护信息

**验收标准**:
- 每台小精灵拥有唯一的设备ID
- 好友关系链存在于设备与设备之间
- App作为管理界面，负责发起申请、确认关系及维护信息

---

### 6. 物理按键系统

**功能描述**: 通过物理按键控制设备状态和功能

**验收标准**:
- 支持通过物理按键进行设备控制（具体按键定义见PRD 3.2.2节）

---

### 7. 灯光交互系统

**功能描述**: 通过灯光效果表达情绪和状态

**验收标准**:
- 支持不同情绪状态的灯光表达
- 支持环境光、唤醒光效、待唤醒光效等
- 支持灯光亮度调整（低中高三档，可完全熄灭）

---

### 8. 电量管理系统

**功能描述**: 监控设备电量，提供电量不足提示

**验收标准**:
- 电量 < 15%时，设备不参与多精灵发声，只微弱闪烁灯光
- 提供电量不足状态提示

---

### 9. 敏感词过滤系统

**功能描述**: 对用户输入进行敏感词过滤，确保内容安全

**验收标准**:
- 实施敏感词过滤策略（详见PRD 3.1.7节）

---

## 业务规则明细

### 语音系统规则
- 音量调整规则：每次增加20%，最小20%，不支持静音，到达最大最小播放反馈
- 亮度调整规则：低中高三档，可完全熄灭，到达最大最小播放反馈

### 多精灵交互规则
- 触发距离：设备间距 < 10cm
- 新成员加入：检测到新ID信号且维持3秒以上
- 位置变动：IMU震动检测 + 距离判定
- 单次交互时长：8-10秒后自动结束
- 自然静默：互动结束后进入"稳定共存态"，不会再次自动触发声音互动
- 夜间静音：睡眠模式（20:00-08:00）时仅触发微弱灯光呼吸同步，不发出声音
- 角色分配：最后发生位移/被放入的小精灵或响应用户触摸的小精灵作为发起者
- 电量不足：电量 < 15%时，不参与发声，只微弱闪烁灯光

### 音效播放规则
- [A,B,C] 3组不同音效每次循环触发
- 不同数量状态下，发起者为新加入或被移动的小精灵，其余几只随机播放不重复音效
- 2-6只设备分别有不同数量的音效组合

---

## 验收标准

### 功能验收标准
- 所有人格能够正确响应用户情绪状态
- 所有语音指令能够被正确识别和执行
- 多精灵交互能够正确触发和执行
- 社交功能能够正常添加和维护好友关系
- 物理按键能够正确控制设备
- 灯光效果能够正确表达情绪和状态
- 电量管理能够正确提示电量不足
- 敏感词过滤能够正确过滤敏感内容

### 性能验收标准
- 语音识别响应时间 < 2秒
- 多精灵交互触发时间 < 1秒
- 音效播放延迟 < 0.5秒

### 兼容性验收标准
- 支持2-6只设备同时交互
- 支持所有人格语言风格
- 支持所有固定语音指令

---

## 边界条件

### 数值边界
- 音量范围：20%-100%，每次调整20%
- 亮度范围：低中高三档，可完全熄灭
- 触发距离：< 10cm
- 单次交互时长：8-10秒
- 电量阈值：< 15%
- 夜间静音时段：20:00-08:00
- 新成员加入判定：维持3秒以上

### 状态边界
- 设备状态：待唤醒状态、聆听状态、传声筒模式、睡眠模式
- 人格状态：快乐、愤怒、悲伤、焦虑、宁静
- 多精灵状态：稳定共存态、互动态

---

## 疑问清单

### 需要用户确认的点

1. **Jira项目类型选择**：
   - 建议使用Software项目，因为涉及代码/构建/发布
   - 是否需要敏捷迭代（Sprint/Backlog）？

2. **Jira Issue类型定义**：
   - Epic：大型功能模块（如"小精灵人设系统"、"语音系统"）
   - Story：用户故事（如"用户可以通过语音指令唤醒设备"）
   - Task：具体任务（如"实现快乐人格的语言风格库"）
   - Bug：缺陷
   - 是否需要其他Issue类型（如Sub-task、Improvement）？

3. **版本规划**：
   - PRD显示版本从v1.0到v1.6
   - 是否需要为每个版本创建Jira版本？
   - 当前开发目标是哪个版本？

4. **迭代规划**：
   - 是否需要按Sprint进行迭代？
   - 每个Sprint的周期（2周/3周/4周）？
   - 是否需要为每个Sprint创建Jira Sprint？

5. **优先级定义**：
   - 是否需要自定义优先级（如Highest、High、Medium、Low、Lowest）？
   - 还是使用Jira默认优先级？

6. **工作流设计**：
   - 是否需要自定义工作流（如To Do → In Progress → In Review → Done）？
   - 是否需要添加额外的状态（如Blocked、Ready for Testing）？

7. **字段配置**：
   - 是否需要自定义字段（如"需求来源"、"验收标准"、"测试用例"）？
   - 是否需要配置必填字段？

8. **权限管理**：
   - 团队成员角色和权限如何分配？
   - 是否需要限制某些Issue类型的创建权限？

---

## 下一步

确认以上需求分析后，将进入**阶段2: Architect（测试架构设计）**，设计Jira项目的整体架构，包括：
- Jira项目类型和配置
- Issue类型定义
- 工作流设计
- 字段配置
- 版本和迭代规划
